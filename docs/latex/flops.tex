
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% auto-generated by:
% ./flops.py
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass{article}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{bm}       % bold symbol

\newcommand{\ph}{\phantom}

% -----
% set 1" margins on 8.5" x 11" paper
% top left is measured from 1", 1"
\topmargin       0in
\oddsidemargin   0in
\evensidemargin  0in
\headheight      0in
\headsep         0in
\topskip         0in
\textheight      9in
\textwidth       6.5in

\begin{document}

\def\arraystretch{1.3}  % 1 is the default, change as needed

\section*{LAPACK and BLAS floating point operation (flop) counts}

BLAS counts assume that $\alpha, \beta = 0$ or $1$,
otherwise a lower-order term is added.
\\
$m, n, k$ are the usual matrix dimensions.
\\
$r$ is the number of right-hand sides (\verb+nrhs+).
\\
L is left, R is right.


\subsection*{Level 2 BLAS}
\begin{tabular}{lll}
function  &  total flops  &  highest order  \\
\hline
gemv                  &  $2 m n$
                      &  $= 2 m n$  \\
symv                  &  $2 n^{2}$
                      &  $= 2 n^{2}$  \\
sbmv                  &  $- 2 k^{2} + 4 k n - 2 k + 2 n$
                      &  $\approx - 2 k^{2} + 4 k n$  \\
trmv                  &  $n^{2}$
                      &  $= n^{2}$  \\
tbmv                  &  $- k^{2} + 2 k n - k + n$
                      &  $\approx - k^{2} + 2 k n$  \\
trsv                  &  $n^{2}$
                      &  $= n^{2}$  \\
tbsv                  &  $- k^{2} + 2 k n - k + n$
                      &  $\approx - k^{2} + 2 k n$  \\
ger                   &  $2 m n$
                      &  $= 2 m n$  \\
syr                   &  $n^{2} + n$
                      &  $\approx n^{2}$  \\
syr2                  &  $2 n^{2} + n$
                      &  $\approx 2 n^{2}$  \\
\end{tabular}


\subsection*{Level 3 BLAS}
\begin{tabular}{lll}
function  &  total flops  &  highest order  \\
\hline
gemm                  &  $2 k m n$
                      &  $= 2 k m n$  \\
symm L                &  $2 m^{2} n$
                      &  $= 2 m^{2} n$  \\
symm R                &  $2 m n^{2}$
                      &  $= 2 m n^{2}$  \\
syrk                  &  $k n^{2} + k n$
                      &  $\approx k n^{2}$  \\
syr2k                 &  $2 k n^{2} + n$
                      &  $\approx 2 k n^{2}$  \\
trmm L                &  $m^{2} n$
                      &  $= m^{2} n$  \\
trmm R                &  $m n^{2}$
                      &  $= m n^{2}$  \\
trsm L                &  $m^{2} n$
                      &  $= m^{2} n$  \\
trsm R                &  $m n^{2}$
                      &  $= m n^{2}$  \\
\end{tabular}


\subsection*{Cholesky}
\begin{tabular}{lll}
function  &  total flops  &  highest order  \\
\hline
posv                  &  $\frac{1}{3} n^{3} + 2 n^{2} r + \frac{1}{2} n^{2} + \frac{1}{6} n$
                      &  $\approx \frac{1}{3} n^{3} + 2 n^{2} r$  \\
potrf                 &  $\frac{1}{3} n^{3} + \frac{1}{2} n^{2} + \frac{1}{6} n$
                      &  $\approx \frac{1}{3} n^{3}$  \\
potrs                 &  $2 n^{2} r$
                      &  $= 2 n^{2} r$  \\
potri                 &  $\frac{2}{3} n^{3} + \frac{1}{2} n^{2} + \frac{5}{6} n$
                      &  $\approx \frac{2}{3} n^{3}$  \\
\end{tabular}


\subsection*{Indefinite factorization}
\begin{tabular}{lll}
function  &  total flops  &  highest order  \\
\hline
sysv                  &  $\frac{1}{3} n^{3} + 2 n^{2} r + \frac{1}{2} n^{2} + \frac{19}{6} n$
                      &  $\approx \frac{1}{3} n^{3} + 2 n^{2} r$  \\
sytrf                 &  $\frac{1}{3} n^{3} + \frac{1}{2} n^{2} + \frac{19}{6} n$
                      &  $\approx \frac{1}{3} n^{3}$  \\
sytrs                 &  $2 n^{2} r$
                      &  $= 2 n^{2} r$  \\
sytri                 &  $\frac{2}{3} n^{3} + \frac{1}{3} n$
                      &  $\approx \frac{2}{3} n^{3}$  \\
\end{tabular}


\subsection*{LU}
\begin{tabular}{lll}
function  &  total flops  &  highest order  \\
\hline
gesv                  &  $\frac{2}{3} n^{3} + 2 n^{2} r - \frac{1}{2} n^{2} - n r + \frac{5}{6} n$
                      &  $\approx \frac{2}{3} n^{3} + 2 n^{2} r$  \\
getrf                 &  $m n^{2} - \frac{1}{3} n^{3} - \frac{1}{2} n^{2} + \frac{5}{6} n$
                      &  $\approx m n^{2} - \frac{1}{3} n^{3}$  \\
getrf, $m = n$        &  $\frac{2}{3} n^{3} - \frac{1}{2} n^{2} + \frac{5}{6} n$
                      &  $\approx \frac{2}{3} n^{3}$  \\
getrs                 &  $2 n^{2} r - n r$
                      &  $\approx 2 n^{2} r$  \\
getri                 &  $\frac{4}{3} n^{3} - n^{2} + \frac{5}{3} n$
                      &  $\approx \frac{4}{3} n^{3}$  \\
\end{tabular}


\subsection*{QR}
\begin{tabular}{lll}
function  &  total flops  &  highest order  \\
\hline
gels, $m \ge n$       &  $2 m n^{2} + 4 m n r + m n - \frac{2}{3} n^{3} - n^{2} r + n^{2} + 3 n r + \frac{14}{3} n$
                      &  $\approx 2 m n^{2} + 4 m n r - \frac{2}{3} n^{3} - n^{2} r$  \\
\ph{gels,} $m = n$    &  $\frac{4}{3} n^{3} + 3 n^{2} r + 2 n^{2} + 3 n r + \frac{14}{3} n$
                      &  $\approx \frac{4}{3} n^{3} + 3 n^{2} r$  \\
geqrf, $m \ge n$      &  $2 m n^{2} + m n - \frac{2}{3} n^{3} + n^{2} + \frac{14}{3} n$
                      &  $\approx 2 m n^{2} - \frac{2}{3} n^{3}$  \\
\ph{geqrf,} $m \le n$  &  $- \frac{2}{3} m^{3} + 2 m^{2} n - m^{2} + 3 m n + \frac{14}{3} m$
                      &  $\approx - \frac{2}{3} m^{3} + 2 m^{2} n$  \\
\ph{geqrf,} $m = n$   &  $\frac{4}{3} n^{3} + 2 n^{2} + \frac{14}{3} n$
                      &  $\approx \frac{4}{3} n^{3}$  \\
ormqr L               &  $4 m n r - 2 n^{2} r + 3 n r$
                      &  $\approx 4 m n r - 2 n^{2} r$  \\
\ph{ormqr} R          &  $- 2 m n^{2} + 4 m n r + 2 m n - \frac{1}{2} n^{2} + n r + \frac{1}{2} n$
                      &  $\approx - 2 m n^{2} + 4 m n r$  \\
orgqr                 &  $\frac{4}{3} k^{3} - 2 k^{2} m - 2 k^{2} n - k^{2} + 4 k m n - k m + 3 k n - \frac{4}{3} k$
                      &  $\approx \frac{4}{3} k^{3} - 2 k^{2} m - 2 k^{2} n + 4 k m n$  \\
\ph{orgqr,} $n = k$   &  $2 m n^{2} - m n - \frac{2}{3} n^{3} + 2 n^{2} - \frac{4}{3} n$
                      &  $\approx 2 m n^{2} - \frac{2}{3} n^{3}$  \\
\ph{orgqr,} $m = n = k$  &  $\frac{4}{3} n^{3} + n^{2} - \frac{4}{3} n$
                      &  $\approx \frac{4}{3} n^{3}$  \\
\end{tabular}


\subsection*{CholQR}
\begin{tabular}{lll}
function  &  total flops  &  highest order  \\
\hline
gels, $m \ge n$       &  $2 m n^{2} + 2 m n r + m n + \frac{1}{3} n^{3} + n^{2} r + \frac{1}{2} n^{2} + \frac{1}{6} n$
                      &  $\approx 2 m n^{2} + 2 m n r + \frac{1}{3} n^{3} + n^{2} r$  \\
\ph{gels,} $m = n$    &  $\frac{7}{3} n^{3} + 3 n^{2} r + \frac{3}{2} n^{2} + \frac{1}{6} n$
                      &  $\approx \frac{7}{3} n^{3} + 3 n^{2} r$  \\
cholqr                &  $2 m n^{2} + m n + \frac{1}{3} n^{3} + \frac{1}{2} n^{2} + \frac{1}{6} n$
                      &  $\approx 2 m n^{2} + \frac{1}{3} n^{3}$  \\
\end{tabular}


\subsection*{LQ}
\begin{tabular}{lll}
function  &  total flops  &  highest order  \\
\hline
gels, $m \le n$       &  $- \frac{2}{3} m^{3} + 2 m^{2} n - m^{2} + 4 m n r + 3 m n + \frac{14}{3} m - n^{2} r + 3 n r$
                      &  $\approx - \frac{2}{3} m^{3} + 2 m^{2} n + 4 m n r - n^{2} r$  \\
gelqf, $m \ge n$      &  $2 m n^{2} + 2 m n - \frac{2}{3} n^{3} + \frac{17}{3} n$
                      &  $\approx 2 m n^{2} - \frac{2}{3} n^{3}$  \\
\ph{gelqf,} $m \le n$  &  $- \frac{2}{3} m^{3} + 2 m^{2} n + 2 m n + \frac{17}{3} m$
                      &  $\approx - \frac{2}{3} m^{3} + 2 m^{2} n$  \\
\ph{gelqf,} $m = n$   &  $\frac{4}{3} n^{3} + 2 n^{2} + \frac{17}{3} n$
                      &  $\approx \frac{4}{3} n^{3}$  \\
ormlq L               &  $4 m n r - 2 n^{2} r + 3 n r$
                      &  $\approx 4 m n r - 2 n^{2} r$  \\
ormlq R               &  $- 2 m n^{2} + 4 m n r + 2 m n - \frac{1}{2} n^{2} + n r + \frac{1}{2} n$
                      &  $\approx - 2 m n^{2} + 4 m n r$  \\
orglq                 &  $\frac{4}{3} k^{3} - 2 k^{2} m - 2 k^{2} n - k^{2} + 4 k m n + 2 k m - \frac{1}{3} k$
                      &  $\approx \frac{4}{3} k^{3} - 2 k^{2} m - 2 k^{2} n + 4 k m n$  \\
orglq, $n = k$        &  $2 m n^{2} + 2 m n - \frac{2}{3} n^{3} - n^{2} - \frac{1}{3} n$
                      &  $\approx 2 m n^{2} - \frac{2}{3} n^{3}$  \\
orglq, $m = n = k$    &  $\frac{4}{3} n^{3} + n^{2} - \frac{1}{3} n$
                      &  $\approx \frac{4}{3} n^{3}$  \\
\end{tabular}


\subsection*{RQ}
\begin{tabular}{lll}
function  &  total flops  &  highest order  \\
\hline
gerqf, $m \ge n$      &  $2 m n^{2} + 2 m n - \frac{2}{3} n^{3} + \frac{17}{3} n$
                      &  $\approx 2 m n^{2} - \frac{2}{3} n^{3}$  \\
\ph{gerqf,} $m \le n$  &  $- \frac{2}{3} m^{3} + 2 m^{2} n + 2 m n + \frac{17}{3} m$
                      &  $\approx - \frac{2}{3} m^{3} + 2 m^{2} n$  \\
\ph{gerqf,} $m = n$   &  $\frac{4}{3} n^{3} + 2 n^{2} + \frac{17}{3} n$
                      &  $\approx \frac{4}{3} n^{3}$  \\
ormrq L               &  $4 m n r - 2 n^{2} r + 3 n r$
                      &  $\approx 4 m n r - 2 n^{2} r$  \\
\ph{ormrq} R          &  $- 2 m n^{2} + 4 m n r + 2 m n - \frac{1}{2} n^{2} + n r + \frac{1}{2} n$
                      &  $\approx - 2 m n^{2} + 4 m n r$  \\
orgrq                 &  $\frac{4}{3} k^{3} - 2 k^{2} m - 2 k^{2} n - k^{2} + 4 k m n + 2 k m - \frac{1}{3} k$
                      &  $\approx \frac{4}{3} k^{3} - 2 k^{2} m - 2 k^{2} n + 4 k m n$  \\
\ph{orgrq,} $n = k$   &  $2 m n^{2} + 2 m n - \frac{2}{3} n^{3} - n^{2} - \frac{1}{3} n$
                      &  $\approx 2 m n^{2} - \frac{2}{3} n^{3}$  \\
\ph{orgrq,} $m = n = k$  &  $\frac{4}{3} n^{3} + n^{2} - \frac{1}{3} n$
                      &  $\approx \frac{4}{3} n^{3}$  \\
\end{tabular}


\subsection*{QL}
\begin{tabular}{lll}
function  &  total flops  &  highest order  \\
\hline
geqlf, $m \ge n$      &  $2 m n^{2} + m n - \frac{2}{3} n^{3} + n^{2} + \frac{14}{3} n$
                      &  $\approx 2 m n^{2} - \frac{2}{3} n^{3}$  \\
\ph{geqlf,} $m \le n$  &  $- \frac{2}{3} m^{3} + 2 m^{2} n - m^{2} + 3 m n + \frac{14}{3} m$
                      &  $\approx - \frac{2}{3} m^{3} + 2 m^{2} n$  \\
\ph{geqlf,} $m = n$   &  $\frac{4}{3} n^{3} + 2 n^{2} + \frac{14}{3} n$
                      &  $\approx \frac{4}{3} n^{3}$  \\
ormql L               &  $4 m n r - 2 n^{2} r + 3 n r$
                      &  $\approx 4 m n r - 2 n^{2} r$  \\
\ph{ormql} R          &  $- 2 m n^{2} + 4 m n r + 2 m n - \frac{1}{2} n^{2} + n r + \frac{1}{2} n$
                      &  $\approx - 2 m n^{2} + 4 m n r$  \\
orgql                 &  $\frac{4}{3} k^{3} - 2 k^{2} m - 2 k^{2} n - k^{2} + 4 k m n - k m + 3 k n - \frac{4}{3} k$
                      &  $\approx \frac{4}{3} k^{3} - 2 k^{2} m - 2 k^{2} n + 4 k m n$  \\
\ph{orgql,} $n = k$   &  $2 m n^{2} - m n - \frac{2}{3} n^{3} + 2 n^{2} - \frac{4}{3} n$
                      &  $\approx 2 m n^{2} - \frac{2}{3} n^{3}$  \\
\ph{orgql,} $m = n = k$  &  $\frac{4}{3} n^{3} + n^{2} - \frac{4}{3} n$
                      &  $\approx \frac{4}{3} n^{3}$  \\
\end{tabular}


\subsection*{Non-symmetric eig}
\begin{tabular}{lll}
function  &  total flops  &  highest order  \\
\hline
gehrd                 &  $\frac{10}{3} n^{3} - \frac{1}{2} n^{2} - \frac{11}{6} n$
                      &  $\approx \frac{10}{3} n^{3}$  \\
\end{tabular}


\subsection*{Symmetric eig}
\begin{tabular}{lll}
function  &  total flops  &  highest order  \\
\hline
sytrd                 &  $\frac{4}{3} n^{3} + 3 n^{2} - \frac{17}{6} n$
                      &  $\approx \frac{4}{3} n^{3}$  \\
\end{tabular}


\subsection*{SVD}
\begin{tabular}{lll}
function  &  total flops  &  highest order  \\
\hline
gesvd, N, $m = n$     &  $\frac{8}{3} n^{3} + 3 n^{2} + \frac{25}{3} n$
                      &  $\approx \frac{8}{3} n^{3}$  \\
gesdd, N, $m = n$     &  $\frac{8}{3} n^{3} + 3 n^{2} + \frac{25}{3} n$
                      &  $\approx \frac{8}{3} n^{3}$  \\
gesvd, N, $m \ge n$   &  $4 m n^{2} - m n - \frac{4}{3} n^{3} + 4 n^{2} + \frac{25}{3} n$
                      &  $\approx 4 m n^{2} - \frac{4}{3} n^{3}$  \\
gesdd, N, $m \ge n$   &  $4 m n^{2} - m n - \frac{4}{3} n^{3} + 4 n^{2} + \frac{25}{3} n$
                      &  $\approx 4 m n^{2} - \frac{4}{3} n^{3}$  \\
gesvd, N, $m \gg n$   &  $2 m n^{2} + m n + 2 n^{3} + 4 n^{2} + 13 n$
                      &  $\approx 2 m n^{2} + 2 n^{3}$  \\
gesdd, N, $m \gg n$   &  $2 m n^{2} + m n + 2 n^{3} + 4 n^{2} + 13 n$
                      &  $\approx 2 m n^{2} + 2 n^{3}$  \\
\hline
gesvd, S, $m = n$     &  $\frac{52}{3} n^{3} + 4 n^{2} + \frac{20}{3} n$
                      &  $\approx \frac{52}{3} n^{3}$  \\
gesdd, S, $m = n$     &  $\frac{28}{3} n^{3} + \frac{15}{2} n^{2} + \frac{53}{6} n$
                      &  $\approx \frac{28}{3} n^{3}$  \\
gesvd, S, $m \ge n$   &  $12 m n^{2} - 2 m n + \frac{16}{3} n^{3} + 6 n^{2} + \frac{20}{3} n$
                      &  $\approx 12 m n^{2} + \frac{16}{3} n^{3}$  \\
gesdd, S, $m \ge n$   &  $8 m n^{2} - m n + \frac{4}{3} n^{3} + \frac{17}{2} n^{2} + \frac{53}{6} n$
                      &  $\approx 8 m n^{2} + \frac{4}{3} n^{3}$  \\
gesvd, S, $m \gg n$   &  $6 m n^{2} + 16 n^{3} + 7 n^{2} + 10 n$
                      &  $\approx 6 m n^{2} + 16 n^{3}$  \\
gesdd, S, $m \gg n$   &  $6 m n^{2} + 8 n^{3} + \frac{21}{2} n^{2} + \frac{73}{6} n$
                      &  $\approx 6 m n^{2} + 8 n^{3}$  \\
\hline
gesvd, A, $m = n$     &  $\frac{52}{3} n^{3} + 4 n^{2} + \frac{20}{3} n$
                      &  $\approx \frac{52}{3} n^{3}$  \\
gesdd, A, $m = n$     &  $\frac{28}{3} n^{3} + \frac{15}{2} n^{2} + \frac{53}{6} n$
                      &  $\approx \frac{28}{3} n^{3}$  \\
gesvd, A, $m \ge n$   &  $4 m^{2} n + 6 m n^{2} + m n + \frac{22}{3} n^{3} + 3 n^{2} + \frac{20}{3} n$
                      &  $\approx 4 m^{2} n + 6 m n^{2} + \frac{22}{3} n^{3}$  \\
gesdd, A, $m \ge n$   &  $4 m^{2} n + 2 m n^{2} + 2 m n + \frac{10}{3} n^{3} + \frac{11}{2} n^{2} + \frac{53}{6} n$
                      &  $\approx 4 m^{2} n + 2 m n^{2} + \frac{10}{3} n^{3}$  \\
gesvd, A, $m \gg n$   &  $4 m^{2} n + 3 m n + 18 n^{3} + 4 n^{2} + 10 n$
                      &  $\approx 4 m^{2} n + 18 n^{3}$  \\
gesdd, A, $m \gg n$   &  $4 m^{2} n + 3 m n + 10 n^{3} + \frac{15}{2} n^{2} + \frac{73}{6} n$
                      &  $\approx 4 m^{2} n + 10 n^{3}$  \\
\hline
gebrd                 &  $4 m n^{2} - m n - \frac{4}{3} n^{3} + 3 n^{2} + \frac{25}{3} n$
                      &  $\approx 4 m n^{2} - \frac{4}{3} n^{3}$  \\
gebrd, $m = n$        &  $\frac{8}{3} n^{3} + 2 n^{2} + \frac{25}{3} n$
                      &  $\approx \frac{8}{3} n^{3}$  \\
\end{tabular}

\vspace{1em} \noindent For $m < n$, swap $m$ and $n$ in above equations.

\subsection*{LAPACK: other computational}
\begin{tabular}{lll}
function  &  total flops  &  highest order  \\
\hline
trtri                 &  $\frac{1}{3} n^{3} + \frac{2}{3} n$
                      &  $\approx \frac{1}{3} n^{3}$  \\
\end{tabular}

\end{document}
